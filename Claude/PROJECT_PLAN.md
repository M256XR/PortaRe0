# Cyberdeck プロジェクト計画書
Cubie A7Z ベース モバイルコンピューター
作成日: 2026-02-19

---

## 1. プロジェクト概要

Cubie A7Z SBCをベースに、5.5インチディスプレイ・フルキーボード・バッテリーを搭載したクラムシェル型のポータブルコンピューター（Cyberdeck）を自作する。PCBはJLCPCBで製造・実装（PCBA）し、筐体は3Dプリンターで自作する。

| 項目 | 内容 |
|------|------|
| コンセプト | クラムシェル型ポータブルPC（Cyberdeckスタイル） |
| メインSBC | Cubie A7Z（Allwinner A733 / 8コア / 3TOPS NPU） |
| ディスプレイ | 5.5" Sharp LS055R1SX04（1440×2560） |
| キーボード | カスタムPCB + Alps SMDスイッチ 60キー |
| 筐体 | 3Dプリンター自作（クラムシェル・ヒンジ構造） |
| PCB製造 | JLCPCB（4層基板 + PCBA） |

---

## 2. 確定済みコンポーネント

### 2.1 主要IC・モジュール

| カテゴリ | 部品名 | 型番 | JLCPCB C番号 | 備考 |
|---------|--------|------|-------------|------|
| SBC | Cubie A7Z | Cubie A7Z | — | メインコンピュータ / Micro HDMI + USB-C出力 |
| ディスプレイ | LCDパネル | LS055R1SX04 | — | 5.5" 1440x2560 / 縦向きパネル |
| ディスプレイ | HDMIコントローラ基板 | 汎用品 | — | HDMI → MIPI DSI変換 |
| 充電管理 | 充電IC | BQ25895RTWR | C80200 | USB PD対応 / バッテリー保護内蔵 |
| 電源変換 | 昇圧DC-DC | TPS61023DRLR | C919459 | LiPo 3.7V → 5V / 最大3.7A |
| 電源変換 | LDO 3.3V | AP2112K-3.3TRG1 | C51118 | 5V → 3.3V（RP2040用） |
| USBハブ | USB 3.0 HUBチップ | VL812-Q7 | C69417 | 1 upstream / 4 downstream |
| USBハブ | SPI Flash | W25Q32JVSSIQ | C82344 | VL812用ファームウェア |
| キーボードMCU | マイコン | RP2040 | C2040 | QMK対応 / ADCでアナログスティック |
| キーボードMCU | SPI Flash | W25Q32JVSSIQ | C82344 | RP2040用プログラム保存（QSPI接続・必須） |
| キーボードMCU | クリスタル | X322512MOB4SI | C70565 | 12MHz 12pF ±10ppm SMD3225-4P / 外付けC 15pF×2 |
| キースイッチ | SMDタクタイル | Alps SKRPABE010 | — | 66キー + ショルダー2個 ※マトリクスに含む |
| ダイオード | スイッチングダイオード | 1N4148W | C2099 | 66個（キーマトリクス用） |
| オーディオ | I2Sアンプ | MAX98357AEWL+T | C2682619 | ×2（ステレオ） |
| バッテリー | LiPoセル | 6060100 | — | 約3500mAh / 3.7V |
| 汎用MOSFET | Nch MOSFET | BSS138 | C52895 | レベルシフト等 |

### 2.2 電源ライン構成

電源フロー:
```
USB-C (充電) → BQ25895 → LiPo 4.2V
LiPo SYS出力 (3.7〜4.2V) → TPS61023 → 5V
5V → AP2112K → 3.3V（RP2040用）
5V → Cubie A7Z / VL812 / HDMIコントローラ基板
```

| 段階 | 入力 | 出力 | 担当部品 |
|------|------|------|---------|
| 充電 | USB-C (5V PD) | LiPo充電 4.2V | BQ25895 |
| 昇圧 | LiPo SYS出力 3.7〜4.2V | 5V（システム電源） | TPS61023 |
| 降圧（3.3V） | 5V | 3.3V（RP2040用） | AP2112K |
| バッテリー保護 | — | 過充電・過放電・過電流保護 | BQ25895内蔵（BMSモジュール不要） |

電源スイッチ:
- 起動：モーメンタリボタン → TPS61023 EN ピン High
- 通常OFF：SBC GPIO → EN Low（shutdown フック）
- 緊急キル：ロック式スイッチ → EN 強制 Low

### 2.3 USBポート割り当て

| SBC側ポート | 接続先 | 用途 |
|------------|--------|------|
| USB-C (USB 3.0) | VL812 (upstream) | USBハブ経由で3系統に分岐 |
| USB-C (USB 2.0) | BQ25895 | 充電入力ポート（刻印:PWR） |
| Micro HDMI | HDMIコントローラ基板 | ディスプレイ信号 |
| VL812 downstream 1 | 外部USB-Cレセプタクル | データポート（刻印:DATA） |
| VL812 downstream 2 | 外部USB-Aレセプタクル | 汎用USBポート |
| VL812 downstream 3 | RP2040 | キーボード接続 |

### 2.4 オーディオ

- MAX98357AEWL+T × 2（ステレオ構成）
- スピーカー：秋月 マイクロスピーカー 8Ω 23×16×4.6mm × 1個（片チャンネル）
- イヤホンジャック：3.5mm TRRS SMT（挿入時スピーカーミュート）
- I2S接続：Cubie A7Z GPIO → ジャンパ3本（BCLK / LRCLK / SDIN）

### 2.5 LED

| LED | 制御 | 役割 |
|-----|------|------|
| 電源LED（緑） | TPS61023 出力（5V） | 電源ON中点灯 |
| 充電中LED（橙） | RP2040（BQ25895 I2C読み） | 充電中点灯 |
| 充電完了LED（緑） | RP2040（BQ25895 I2C読み） | 満充電点灯 |
| ACT LED | RP2040（USB経由でSBCから制御） | OS動作表示 |

### 2.6 冷却

- 方式：パッシブ（ヒートパイプ + 小型ヒートシンク）
- ヒートパイプ：3mm厚フラット銅製、SoC → 90度曲げ → バッテリー上端の隙間（幅16mm）を通過
- ヒートシンク：14×9×4mm 程度 × 4個（サーマルパッドで密着）
- ファン：スペース確保のみ（Cubie A7Z 内蔵ファンコネクタ経由で後付け可）

---

## 3. 設計上の決定事項

### 3.1 PCB構成

- メインキーボードPCB：4層基板（信号 / GND / 電源 / 信号）
- サブ基板（SBC接続用）：メインPCBのスロット穴に垂直挿入する形式
- 実装：JLCPCB PCBAを活用（QFNパッケージICはPCBA必須）
- HDMI差動ペア：90Ω / 等長配線
- USB3.0 SS差動ペア：90Ω

### 3.2 筐体

- クラムシェル構造（ボトム：SBC・バッテリー収納 / リッド：ディスプレイ収納）
- 素材：3Dプリンター（FDM or SLA）で自作
- ボトム外形目安：139×81mm
- ヒンジ：3Dプリント or 市販品流用（要検討）

### 3.3 入力デバイス

- キースイッチ：Alps SKRPABE010（SMD タクタイル 4.2×3.2mm）× 66キー（C115360）
- アナログスティック：3DSスライドパッド（カーソル操作用）/ FPC 6ピン 0.5mmピッチ
- FPCコネクタ：AFC01-S06FCA-00（C262655）/ Bottom Contact ZIF
- ショルダーボタン：SKRPABE010 × 2（L/Rボタン）※マトリクスに含む

### 3.4 キーレイアウト（KLE形式）

```
["Left",{x:13},"Right"],
["esc","1","2","3","4","5","6","7","8","9","0","-","^","\\","BS"],
[{w:1.5},"h/z","Q","W","E","R","T","Y","U","I","O","P","@","[",{x:0.25,a:7,w:1.25,h:2,w2:1.5,h2:1,x2:-0.25},""],
[{a:4,w:1.75},"Tab","A","S","D","F","G","H","J","K","L",";",":","]"],
[{w:2},"Shift","Z","X","C","V","B","N","M",",",".","/","\\",{w:2},"RShift"],
[{x:4.5,w:4.5},"Space",{x:0.5},"Back","Next",{x:0.5},"Ctrl","Fn","Alt"]
```

- 合計66キー / 9×8マトリクス（COL9本 + ROW8本 = 17本）

### 3.5 RP2040 GPIO割り当て

| 用途 | GPIO | 本数 |
|---|---|---|
| キーマトリクス COL | GP0〜GP8 | 9本 |
| キーマトリクス ROW | GP9〜GP16 | 8本 |
| I2C SCL（BQ25895） | GP17 | 1本 |
| I2C SDA（BQ25895） | GP18 | 1本 |
| BQ_INT | GP19 | 1本 |
| RP2040_EN | GP20 | 1本 |
| I2S BCLK | GP21 | 1本 |
| I2S LRCLK | GP22 | 1本 |
| I2S SDIN | GP23 | 1本 |
| LED_CHG（充電中・橙） | GP24 | 1本 |
| LED_FULL（充電完了・緑） | GP25 | 1本 |
| LED_ACT（ACT） | GP26（ADC0兼用） | 1本 |
| アナログスティック X | GP27（ADC1） | 1本 |
| アナログスティック Y | GP28（ADC2） | 1本 |
| 予備 | GP29（ADC3） | 1本 |
| **合計** | | **29本（30本中）** |

### 3.6 RP2040 クリスタル

| 項目 | 値 |
|------|----|
| 型番 | X322512MOB4SI（C70565） |
| 周波数 | 12MHz |
| 負荷容量 | 12pF |
| 精度 | ±10ppm |
| パッケージ | SMD3225-4P |
| 外付けC | 15pF × 2（XIN/XOUT各1個） |
| 接続 | XIN(Pin20) / XOUT(Pin21) |

### 3.7 RP2040 外部SPI Flash接続

RP2040は内蔵Flashを持たないため、外部W25Q32（QSPI接続）が必須。

| W25Q32ピン | RP2040ピン | 処理 |
|------------|-----------|------|
| 1 /CS | QSPI_SS (Pin56) | 10kΩ → +3V3 プルアップ |
| 2 DO (IO1) | QSPI_SD1 (Pin55) | 直結 |
| 3 /WP (IO2) | QSPI_SD2 (Pin54) | 直結（Quad SPI時はIO2として使用） |
| 4 GND | GND | GND |
| 5 DI (IO0) | QSPI_SD0 (Pin53) | 直結 |
| 6 CLK | QSPI_SCLK (Pin52) | 直結 |
| 7 /HOLD (IO3) | QSPI_SD3 (Pin51) | 直結（Quad SPI時はIO3として使用） |
| 8 VCC | +3V3 | 100nF デカップリング |

※VL812用W25Q32とは別部品（合計2個必要）

---

## 4. 実装難易度評価

| 部品 | 難易度 | 理由 | 対策 |
|------|--------|------|------|
| BQ25895 | 高 | QFN 24ピン・露出パッド | JLCPCB PCBA必須 |
| VL812 | 高 | QFN 76ピン・9×9mm | JLCPCB PCBA必須 |
| RP2040 | 中〜高 | QFN 56ピン | JLCPCB PCBA |
| HDMI差動ペア配線 | 高 | 90Ω差動・等長配線が必要 | KiCad 4層構成で対応 |
| USB 3.0 SS配線 | 中〜高 | VL812〜SBC間 90Ω差動 | 同上 |
| TPS61023 | 低〜中 | SOT563 6ピン・外付け部品少ない | PCBAで対応 |

---

## 5. 未決事項（TBD）

| 項目 | 現状 | 決定に必要なこと |
|------|------|----------------|
| インダクタ（BQ25895用） | TBD | スイッチング周波数・電流値から計算 |
| インダクタ（TPS61023用） | 1µH前後 | JLCPCB在庫確認 |
| FPCコネクタ/ケーブル | ピン数・長さ未定 | HDMIコントローラ基板のコネクタ仕様確認 |
| キルスイッチ型番 | TBD | KiCad フットプリント決める時 |
| アナログスティック最終選定 | **3DSスライドパッド確定** | FPCコネクタ C262655 で対応 |
| キーキャップ | 薄型対応品 | スイッチとの嵌合確認 |
| ヒンジ機構 | 3Dプリント or 市販品 | 筐体設計と並行検討 |
| RTCバッテリー有無 | 未確認 | A7Z実機届いたら確認 |
| ヒートパイプ取り回し経路 | 未確認 | 筐体CAD後 |
| WiFiアンテナ配置 | 未確認 | 筐体CAD後 |

---

## 6. 今後の進め方

### Phase 1：部品選定 ✅ 完了
- 主要IC 全部の JLCPCB 在庫確認済み
- BOMファイル確定: `bom/cyberdeck_bom.xlsx`
- GitHubリポジトリ作成: https://github.com/M256XR/PortaRe0
- KiCadプロジェクト・ライブラリ設定済み

### Phase 2：回路設計 🔄 進行中
- KiCad 階層シート構成：メイン + power / usb_hub / keyboard / audio
- [ ] BQ25895 powerシート完成（TS修正 + 右側・上側ピン）
- [ ] TPS61023 昇圧回路（インダクタ値計算が必要）
- [ ] AP2112K LDO 回路
- [ ] VL812 usb_hub シート
- [ ] RP2040 keyboard シート
- [ ] MAX98357A × 2 audio シート
- [ ] コネクタ類（SBC接続・外部ポート・FPC 30ピン）

### Phase 3：PCBレイアウト ⏳ 未着手
- 4層スタックアップの設定（信号・GND・電源・信号）
- HDMI差動ペアの等長配線（90Ω）
- USB 3.0 SuperSpeed差動ペアの配線（90Ω）
- 電源プレーンの整備・デカップリングコンデンサ配置
- サブ基板のスロット穴とカードエッジ設計

### Phase 4：試作・検証 ⏳ 未着手
- JLCPCBへ発注（PCBA込み）
- 電源系の動作確認（BQ25895 → TPS61023 → 5V）
- SBC起動確認・ディスプレイ表示確認
- キーボード・USB HUBの動作確認

### Phase 5：筐体設計・組み立て ⏳ 未着手
- PCB寸法確定後にFusion 360 or OpenSCADで筐体モデリング
- 3Dプリント・試作フィット確認
- ヒンジ・ボタン・コネクタ穴の調整
- 最終組み立て

---

## 7. 参考情報

| 部品 | 型番 | 参考先 |
|------|------|--------|
| SBC | Cubie A7Z | Radxa 公式 |
| 充電IC | BQ25895 | Texas Instruments |
| 昇圧DC-DC | TPS61023 | Texas Instruments |
| USBハブ | VL812-Q7 | VIA Labs |
| キーボードMCU | RP2040 | Raspberry Pi / QMK |
| PCB製造 | — | JLCPCB (jlcpcb.com) |
